# 💰 结婚生育成本计算器

<div align="center">

**一个基于Python的现代化GUI应用程序，用于计算和分析结婚生育的综合成本，帮助家庭做出更明智的财务决策。**

[![Python Version](https://img.shields.io/badge/python-3.7+-blue.svg)](https://www.python.org/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Platform](https://img.shields.io/badge/platform-Windows%20%7C%20macOS%20%7C%20Linux-lightgrey.svg)](https://github.com/)

*🏠 量化婚姻生育的经济压力 • 📊 可视化18年财务规划 • 🤖 AI智能风险评估*

</div>

---

## 📋 目录

- [🚀 快速开始](#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B)
- [✨ 功能特点](#%E5%8A%9F%E8%83%BD%E7%89%B9%E7%82%B9)
- [📦 安装指南](#%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97)
- [🎮 使用教程](#%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B)
- [📊 数据说明](#%E6%95%B0%E6%8D%AE%E8%AF%B4%E6%98%8E)
- [⚙️ 高级配置](#%E9%AB%98%E7%BA%A7%E9%85%8D%E7%BD%AE)
- [🔧 故障排除](#%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4)
- [📚 技术文档](#%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3)
- [🤝 贡献指南](#%E8%B4%A1%E7%8C%AE%E6%8C%87%E5%8D%97)
- [📝 更新日志](#%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97)
- [📄 许可证](#%E8%AE%B8%E5%8F%AF%E8%AF%81)
- [🙋‍♂️ 常见问题](#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98)

---

## 🚀 快速开始 {#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B}

### ⚡ 一键启动（推荐）

**Windows用户：**
```bash
# 双击运行批处理文件
run_calculator.bat
```

**macOS/Linux用户：**
```bash
# 终端运行
python marriage_calculator.py
```

### 📸 界面预览

程序启动后，您将看到：

```
┌─────────────────────────────────────────┐
│        资产头寸与生存压力模型           │
│ 动态计入房产波动、货币贬值、收入稳定性与隔代支持 │
│                                         │
│ 18年综合净资产变化预期: 123.4万          │
│                                         │
│ ┌─────────┬─────────┬─────────┐       │
│ │参数设置 │成本分析 │AI分析  │数据管理│ │
│ └─────────┴─────────┴─────────┘       │
└─────────────────────────────────────────┘
```

---

## ✨ 功能特点 {#%E5%8A%9F%E8%83%BD%E7%89%B9%E7%82%B9}

### 🎯 核心功能

| 功能模块 | 描述 | 特色亮点 |
|---------|------|---------|
| **精确成本计算** | 详细计算结婚和生育的全生命周期成本 | 支持18年长期规划，按阶段精确计算 |
| **实时可视化** | 动态图表展示财务状况变化 | matplotlib专业图表，实时更新 |
| **风险评估** | 现金流分析、抗风险系数评估 | 多维度风险指标，智能预警 |
| **AI分析报告** | 智能生成财务建议报告 | 基于数据分析的专业建议 |
| **多场景预设** | 支持不同城市和风险偏好配置 | 6种预设场景，一键切换 |

### 📊 成本细分

#### 💍 结婚成本明细
- **彩礼**：根据地区风俗习惯调整
- **婚礼仪式**：酒席、摄影、婚庆、喜糖等
- **钻戒首饰**：结婚戒指及其他饰品
- **蜜月旅行**：国内外旅游消费
- **新房首付**：购房首付款
- **装修费用**：硬装、软装、家电等

#### 👶 生育教育成本明细
- **产前检查**：15次左右检查 + 营养品
- **分娩费用**：顺产/剖腹产医疗费用
- **月子中心**：42天专业护理服务
- **婴儿用品**：奶粉、尿布、辅食等月均消费
- **幼儿园**：公立园+兴趣班（3年）
- **小学教育**：公立学校学杂费（6年）
- **初中教育**：公立教育+补习（3年）
- **高中教育**：公立教育+补习（3年）
- **本科教育**：学费+生活费（4年）
- **课外辅导**：英语、奥数等专项培训

## 📦 安装指南 {#%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97}

### 🔧 系统要求

| 组件 | 最低要求 | 推荐配置 |
|-----|---------|---------|
| **Python版本** | 3.7.0+ | 3.9.0+ |
| **内存** | 2GB RAM | 4GB RAM |
| **存储空间** | 100MB | 500MB |
| **操作系统** | Windows 7+ / macOS 10.12+ / Ubuntu 16.04+ | Windows 10+ / macOS 12+ / Ubuntu 20.04+ |
| **显示器** | 1366x768分辨率 | 1920x1080分辨率 |

### 📥 下载安装

#### 方法1：克隆仓库（推荐）
```bash
# 克隆项目
git clone https://github.com/abwoo/Marriage-Parenting-Cost-Calculator.git
cd Marriage-Parenting-Cost-Calculator

# 安装依赖
pip install -r requirements.txt
```

#### 方法2：直接下载
1. 从 [GitHub Releases](https://github.com/abwoo/Marriage-Parenting-Cost-Calculator/releases) 下载最新版本
2. 解压到本地目录
3. 运行安装脚本

### ⚙️ 依赖包安装

项目依赖的Python包：

```bash
# 核心依赖
pip install customtkinter==5.2.2    # 现代化GUI框架
pip install matplotlib==3.7.1       # 数据可视化
pip install numpy==1.24.2          # 数值计算
pip install pillow==9.5.0          # 图像处理

# 可选依赖（增强功能）
pip install pandas                    # 数据处理
pip install openpyxl                  # Excel文件支持
```

### 🚀 运行程序

#### 🪟 Windows用户
```bash
# 方法1：双击运行（推荐）
run_calculator.bat

# 方法2：命令行运行
python marriage_calculator.py

# 方法3：Python模块运行
python -m marriage_calculator
```

#### 🍎 macOS用户
```bash
# 终端运行
python marriage_calculator.py

# 或者使用Python 3明确指定
python3 marriage_calculator.py
```

#### 🐧 Linux用户
```bash
# Ubuntu/Debian
sudo apt-get install python3-tk  # 安装Tkinter支持
python3 marriage_calculator.py

# CentOS/RHEL
sudo yum install tkinter
python3 marriage_calculator.py
```

### 🔍 验证安装

运行程序后，您应该看到：

```
╔══════════════════════════════════════╗
║          结婚生育成本计算器            ║
║                                      ║
║  一个帮助您规划家庭财务的现代化工具     ║
╚══════════════════════════════════════╝

正在检查Python环境...
✅ Python环境正常
正在检查依赖包...
✅ 依赖包已安装
正在启动应用程序...
```

如果遇到问题，请查看 [故障排除](#故障排除) 部分。

## 🎮 使用教程 {#%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B}

### 📖 基础使用流程

```
开始使用 → 参数设置 → 计算分析 → 查看结果 → 导出报告
```

### 🏠 第一步：参数设置

在 **"参数设置"** 选项卡中输入您的实际情况：

#### 💰 收入与稳定性设置

| 参数 | 说明 | 示例 | 影响因素 |
|-----|------|------|---------|
| **配偶A月薪** | 丈夫/主要经济来源月收入 | 18,000元 | 决定家庭主要收入来源 |
| **配偶B月薪** | 妻子月收入 | 16,000元 | 补充家庭收入 |
| **年终奖** | 全年奖金合计 | 80,000元 | 影响年度总收入 |
| **工资稳定性** | 收入波动风险（0-100%） | 85% | 越高收入越稳定 |

**💡 提示：**
- 月薪按税前金额填写
- 年终奖包括所有年度奖金
- 稳定性基于行业特征：公务员/教师95%，IT行业75%，销售50%

#### 🏠 房产资产设置

| 参数 | 说明 | 示例 | 计算方式 |
|-----|------|------|---------|
| **房产总市值** | 当前房产评估价值 | 1,800,000元 | 基于购买价或评估价 |
| **预期年化增值率** | 房价年增长率 | -1.2% | 基于历史数据和预期 |
| **月供总额** | 房贷月还款额 | 6,500元 | 包含本金+利息 |

**📊 房产增值率参考：**
- **一线城市**：-0.5% 到 2.0%（北京、上海等）
- **二线城市**：-1.5% 到 1.5%（杭州、南京等）
- **三线城市**：-2.5% 到 0.5%（普通地级市）

#### 💍 结婚成本设置

详细填写各项结婚支出：

| 类别 | 包含项目 | 二线城市参考 | 一线城市参考 |
|-----|---------|-------------|-------------|
| **彩礼** | 见面礼+聘礼 | 58,000元 | 120,000元 |
| **婚礼仪式** | 酒席+摄影+婚庆 | 128,000元 | 200,000元 |
| **钻戒首饰** | 结婚戒指+饰品 | 35,000元 | 60,000元 |
| **蜜月旅行** | 旅游费用 | 45,000元 | 80,000元 |
| **新房首付** | 购房首付款 | 360,000元 | 1,200,000元 |
| **装修费用** | 硬装+软装 | 180,000元 | 400,000元 |

#### 👶 生育教育成本设置

| 阶段 | 费用项目 | 参考金额 | 说明 |
|-----|---------|---------|------|
| **孕产期** | 产检+分娩+月子 | 42,500元 | 15次检查+顺产+42天月子 |
| **0-3岁** | 婴儿用品 | 2200元/月 | 奶粉+尿布+辅食等 |
| **3-6岁** | 幼儿园 | 96,000元 | 公立园+兴趣班 |
| **6-12岁** | 小学教育 | 180,000元 | 6年学杂费 |
| **12-15岁** | 初中教育 | 156,000元 | 3年教育+补习 |
| **15-18岁** | 高中教育 | 132,000元 | 3年教育+补习 |
| **18-22岁** | 本科教育 | 720,000元 | 4年学费+生活费 |

#### ⚙️ 其他参数设置

| 参数 | 说明 | 默认值 | 影响 |
|-----|------|--------|------|
| **孩子数量** | 计划生育子女数 | 1个 | 直接影响总成本 |
| **父母年支持** | 每年获得的父母资助 | 35,000元 | 补充家庭收入 |
| **投资收益率** | 理财产品预期年化 | 3.8% | 影响结余收益 |
| **生活通胀率** | 年度生活成本增长 | 2.1% | 影响未来支出 |

### 📊 第二步：成本分析

切换到 **"成本分析"** 选项卡查看结果：

#### 📈 财务损益图表

图表显示18年生命周期的财务变化：

- **🟢 绿色柱状图**：资产增值（房产、投资等收益）
- **🟡 黄色柱状图**：结婚生育成本支出
- **🔵 蓝色柱状图**：投资收益和父母支持
- **⚫ 黑色线条**：综合家庭损益走势
- **🔘 灰色区域**：净现金流状况

#### 📋 关键指标统计

| 指标 | 含义 | 理想范围 | 风险提示 |
|-----|------|---------|---------|
| **总成本** | 18年全部支出 | - | 预算控制参考 |
| **结婚成本** | 结婚相关费用 | <50万 | 控制婚礼规模 |
| **教育成本** | 子女教育支出 | <100万/人 | 关注教育规划 |
| **最低现金流** | 最差时期月结余 | >0 | 现金流风险警示 |
| **抗风险系数** | 收入支出比值 | >1.5 | 财务健康度量 |

### 🤖 第三步：AI智能分析

在 **"AI分析"** 选项卡中获取专业建议：

#### 🔍 分析维度

1. **资产流动性评估**：检查家庭资产变现能力
2. **房产抗风险能力**：评估房产在经济波动中的稳定性
3. **中产返贫风险**：分析家庭财务健康状况
4. **优化建议**：提供针对性的改进方案

#### 📝 分析报告示例

```
深度资产审计报告 (AI Generated)
====================================

📊 财务状况概览
总资产变化: 245.6万
结婚成本: 31.4万
教育成本: 109.5万

🏠 房产风险评估
当前市值: 180万
预期年化: -1.2%
18年贬值风险: 45.2万

💰 现金流分析
最低现金流: 2.3万
抗风险系数: 1.85
建议系数: >1.5 (当前良好)

💡 优化建议
1. 合理控制结婚成本，避免过度消费
2. 提前规划教育基金，建立专项理财
3. 提高收入稳定性，降低行业风险
```

### 💾 第四步：数据管理

**"数据管理"** 选项卡提供完整的数据管理功能：

#### 💾 配置管理

```bash
# 保存当前设置
marriage_calculator_config.json

# 自动备份历史配置
config_backup_20240121.json
```

#### 📄 报告导出

导出包含以下内容的分析报告：

- **财务概况**：收入、支出、资产变化
- **成本明细**：各阶段费用 breakdown
- **风险评估**：现金流、抗风险系数分析
- **优化建议**：基于数据分析的专业建议

#### 🎯 预设配置

##### 城市配置

| 配置 | 适用城市 | 收入水平 | 房价水平 | 结婚成本 |
|-----|---------|---------|---------|---------|
| **一线城市** | 北京、上海、深圳 | 高收入 | 12万/㎡ | 52.6万 |
| **二线城市** | 杭州、南京、成都 | 中等收入 | 2-3万/㎡ | 31.4万 |
| **三线城市** | 普通地级市 | 较低收入 | 6-8千/㎡ | 17.8万 |

##### 风险偏好配置

| 配置 | 适合人群 | 杠杆水平 | 投资风格 | 父母依赖 |
|-----|---------|---------|---------|---------|
| **保守型** | 风险厌恶者 | 低杠杆 | 稳健投资 | 高依赖 |
| **激进型** | 风险偏好者 | 高杠杆 | 激进投资 | 低依赖 |
| **平衡型** | 大多数家庭 | 中等杠杆 | 均衡配置 | 中等依赖 |

### 🎨 第五步：个性化调整

#### 自定义参数

- **地域调整**：根据您所在城市的具体数据调整
- **消费习惯**：根据家庭消费水平调整各项费用
- **投资偏好**：根据风险承受能力调整收益率预期
- **子女规划**：根据教育期望调整教育成本

#### 实时预览

所有参数调整都会：
- ✅ 实时计算并更新图表
- ✅ 动态显示关键指标变化
- ✅ 自动生成新的分析报告

## 📊 数据说明 {#%E6%95%B0%E6%8D%AE%E8%AF%B4%E6%98%8E}

### 📚 数据来源

本程序的数据基于2023年权威统计数据和专业研究报告，详细数据来源请参考 [`数据来源说明.md`](数据来源说明.md) 文件：

#### 🏛️ 官方统计数据
- **📊 国家统计局**：《中国统计年鉴2023》、《中国人口和就业统计年鉴》
- **🏛️ 民政部**：婚姻登记统计年报、婚姻家庭建设统计
- **🏥 卫健委**：卫生健康统计年鉴、生育健康统计
- **📚 教育部**：全国教育事业发展统计公报
- **🏠 住建部**：房地产市场统计报告

#### 📈 行业研究报告
- **婚庆行业**：中国婚庆产业报告、婚礼消费白皮书
- **房地产**：中国房价指数报告、各城市房价数据
- **教育培训**：中国教育消费报告、课外辅导市场分析
- **生育服务**：母婴消费报告、月子中心行业报告

### 🎯 默认参数详解

#### 二线城市基准配置（杭州、南京等）

##### 💰 收入结构
```json
{
  "月收入": "40,000元",
  "年终奖": "80,000元",
  "年度总收入": "560,000元",
  "工资稳定性": "82%"
}
```

##### 🏠 房产配置
```json
{
  "总市值": "1,800,000元",
  "月供": "6,500元",
  "贷款年限": "30年",
  "预期增值率": "-1.2%"
}
```

##### 💍 结婚成本结构
```json
{
  "彩礼": "58,000元",
  "婚礼仪式": "128,000元",  // 酒席+摄影+婚庆
  "钻戒首饰": "35,000元",
  "蜜月旅行": "45,000元",
  "新房首付": "360,000元",
  "装修费用": "180,000元",
  "总计": "314,000元"
}
```

##### 👶 生育教育成本结构
```json
{
  "孕产期费用": "42,500元",  // 产检+分娩+月子
  "0-3岁": "237,600元",     // 3年婴儿用品+早期教育
  "3-6岁": "96,000元",      // 幼儿园
  "6-12岁": "180,000元",    // 小学
  "12-15岁": "156,000元",   // 初中
  "15-18岁": "132,000元",   // 高中
  "18-22岁": "720,000元",   // 本科
  "教育总计": "1,095,000元"
}
```

##### 📈 其他参数
```json
{
  "父母年支持": "35,000元",
  "投资收益率": "3.8%",
  "生活通胀率": "2.1%",
  "孩子数量": 1
}
```

### 🌍 城市差异对比

| 维度 | 一线城市 | 二线城市 | 三线城市 |
|-----|---------|---------|---------|
| **代表城市** | 北京、上海 | 杭州、南京 | 普通地级市 |
| **夫妻月收入** | 52,000元 | 40,000元 | 22,000元 |
| **房产均价** | 120,000元/㎡ | 25,000元/㎡ | 8,000元/㎡ |
| **结婚总成本** | 526,000元 | 314,000元 | 178,000元 |
| **生育总成本** | 279,500元 | 151,700元 | 88,700元 |
| **父母支持** | 60,000元 | 35,000元 | 20,000元 |
| **抗风险系数** | 1.65 | 1.85 | 2.05 |

### ⚖️ 风险偏好对比

| 维度 | 保守型 | 平衡型 | 激进型 |
|-----|-------|-------|-------|
| **杠杆水平** | 低 (45%) | 中 (65%) | 高 (75%) |
| **投资收益率** | 3.0% | 4.5% | 7.0% |
| **父母依赖** | 高 (45,000元) | 中 (38,000元) | 低 (25,000元) |
| **房产配置** | 150万 | 220万 | 280万 |
| **风险等级** | 低 | 中 | 高 |
| **适合人群** | 稳健投资者 | 大多数家庭 | 高风险偏好者 |

### 🧮 成本计算逻辑

#### 📅 时间线计算

```
结婚准备 (1年) → 0-3岁 (3年) → 3-6岁 (3年) → 6-12岁 (6年) → 12-15岁 (3年) → 15-18岁 (3年)
    ↓           ↓          ↓          ↓            ↓            ↓
一次性支出   婴儿用品    幼儿园     小学教育     初中教育     高中教育
房产增值     早期教育   兴趣班     校服学杂     补习班       补习班
投资收益     月子费用   教育基金   兴趣班       竞赛培训     大学准备
父母支持     医疗费用   保险费用   体检费用     心理辅导     生涯规划
```

#### 💰 现金流计算

**每月净现金流 = 月收入 + 月投资收益 + 月父母支持 - 月支出**

其中：
- **月收入** = (年收入 + 年终奖) ÷ 12 × 稳定性系数
- **月支出** = 月供 + 生活费 + 子女抚养费 + 通胀调整
- **月投资收益** = 结余 × 年化收益率 ÷ 12

#### 📊 资产增值计算

**房产价值 = 初始价值 × (1 + 年化增值率)^年数**

**投资收益 = 每月结余 × (1 + 年化收益率)^年数**

#### 🎯 风险指标计算

**抗风险系数 = 月收入 ÷ 月支出**

- **> 2.0**：财务状况非常健康，有较大缓冲
- **1.5-2.0**：财务状况良好，风险可控
- **1.0-1.5**：财务状况一般，需要关注
- **< 1.0**：财务状况紧张，建议调整

**现金流风险 = 最小月结余 ÷ 月支出**

- **> 0.5**：现金流充足
- **0.2-0.5**：现金流一般
- **0-0.2**：现金流紧张
- **< 0**：现金流断裂风险

### 📈 数据更新机制

- **年度更新**：随国家统计年鉴发布更新基准数据
- **季度调整**：根据CPI、房价指数调整参数
- **用户自定义**：支持根据个人实际情况调整参数
- **历史回溯**：保留历史数据用于对比分析

## ⚙️ 高级配置 {#%E9%AB%98%E7%BA%A7%E9%85%8D%E7%BD%AE}

### 🔧 自定义参数调整

#### 地域参数自定义

```python
# 在marriage_calculator.py中修改城市数据
CITY_PRESETS = {
    "您的城市": {
        'salaryA': 20000,        # 当地平均薪资
        'salaryB': 18000,
        'propertyValue': 2500000, # 当地房价水平
        'marriageCosts': {
            'betrothalGift': 80000,     # 当地彩礼水平
            'weddingCeremony': 150000,  # 当地婚礼价格
            # ... 其他参数
        }
    }
}
```

#### 投资策略配置

```python
# 自定义投资组合
INVESTMENT_STRATEGIES = {
    "保守组合": {
        "股票": 0.2,
        "债券": 0.3,
        "基金": 0.3,
        "理财": 0.2,
        "预期年化": 3.5%
    },
    "激进组合": {
        "股票": 0.6,
        "基金": 0.3,
        "衍生品": 0.1,
        "预期年化": 8.0%
    }
}
```

### 📊 数据导出格式

#### Excel报告格式

程序可以导出包含以下工作表的Excel文件：

1. **概况表**：基本参数和总览数据
2. **现金流表**：逐月现金流明细
3. **成本明细表**：各项支出详细分解
4. **资产负债表**：资产和负债变化
5. **风险分析表**：各项风险指标

#### JSON配置格式

```json
{
  "version": "1.0.0",
  "timestamp": "2024-01-21T10:00:00Z",
  "parameters": {
    "income": {...},
    "assets": {...},
    "costs": {...}
  },
  "results": {
    "total_cost": 1456700,
    "net_asset_change": 245600,
    "risk_score": 1.85
  }
}
```

---

## 🔧 故障排除 {#%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4}

### 🚫 常见问题及解决方案

#### 程序无法启动

**问题现象：**
```
Python环境未找到
依赖包安装失败
窗口无法显示
```

**解决方案：**

1. **检查Python环境**
   ```bash
   python --version
   # 应该显示 Python 3.7.0 或更高版本
   ```

2. **重新安装依赖**
   ```bash
   pip uninstall customtkinter matplotlib numpy pillow
   pip install -r requirements.txt
   ```

3. **检查杀毒软件**
   - 临时关闭杀毒软件
   - 将程序添加到信任列表

#### 图表显示异常

**问题现象：**
```
文字显示为方块
坐标轴标签缺失
图例重叠
```

**解决方案：**

1. **字体问题修复**
   ```python
   # 检查系统字体
   import matplotlib.font_manager as fm
   print([f.name for f in fm.fontManager.ttflist if 'SimHei' in f.name])
   ```

2. **重置matplotlib配置**
   ```bash
   # 删除matplotlib缓存
   rm -rf ~/.matplotlib/*
   # 重新运行程序
   ```

3. **降级matplotlib**
   ```bash
   pip install matplotlib==3.5.0
   ```

#### 数据计算错误

**问题现象：**
```
结果显示NaN
数值异常大
计算时间过长
```

**解决方案：**

1. **检查输入数据**
   - 确保所有数值字段都不为空
   - 检查数值范围是否合理

2. **重置参数**
   - 使用预设配置重新开始
   - 检查自定义参数格式

3. **清除缓存**
   - 删除 `marriage_calculator_config.json`
   - 重新启动程序

#### 内存不足错误

**问题现象：**
```
MemoryError
程序无响应
```

**解决方案：**

1. **增加系统内存**
2. **优化参数设置**
   - 减少计算周期
   - 简化图表显示

3. **重启程序**
   ```bash
   taskkill /f /im python.exe
   python marriage_calculator.py
   ```

### 📞 获取帮助

#### 调试模式运行

```bash
# 启用详细日志
set PYTHONVERBOSE=1
python marriage_calculator.py
```

#### 生成诊断报告

程序内置诊断功能：

1. 打开程序
2. 进入"数据管理"选项卡
3. 点击"导出诊断报告"
4. 将报告发送给技术支持

### 🔄 版本兼容性

| Python版本 | 兼容性 | 推荐程度 |
|-----------|-------|---------|
| 3.7.x | ✅ 完全兼容 | ⭐⭐⭐ |
| 3.8.x | ✅ 完全兼容 | ⭐⭐⭐⭐ |
| 3.9.x | ✅ 完全兼容 | ⭐⭐⭐⭐⭐ |
| 3.10.x | ✅ 完全兼容 | ⭐⭐⭐⭐⭐ |
| 3.11.x | ✅ 完全兼容 | ⭐⭐⭐⭐⭐ |
| 3.12.x | ⚠️ 部分兼容 | ⭐⭐ |

---

## 📚 技术文档 {#%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3}

### 🏗️ 系统架构

```
┌─────────────────────────────────────────┐
│           用户界面层 (UI Layer)         │
│  ┌─────────────────────────────────────┐ │
│  │  CustomTkinter GUI                 │ │
│  │  - 参数设置界面                     │ │
│  │  - 图表显示区域                     │ │
│  │  - 结果展示面板                     │ │
│  └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────┐
│         业务逻辑层 (Business Layer)     │
│  ┌─────────────────────────────────────┐ │
│  │  财务计算引擎                       │ │
│  │  - 成本计算模块                     │ │
│  │  - 现金流分析模块                   │ │
│  │  - 风险评估模块                     │ │
│  │  - AI分析模块                       │ │
│  └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────┐
│          数据持久层 (Data Layer)        │
│  ┌─────────────────────────────────────┐ │
│  │  配置管理                           │ │
│  │  - JSON配置存储                     │ │
│  │  - Excel报告导出                    │ │
│  │  - 数据验证与恢复                   │ │
│  └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

### 📁 项目结构

```
Marriage-Parenting-Cost-Calculator/
├── marriage_calculator.py      # 主程序文件
├── run_calculator.bat          # Windows启动脚本
├── run_calculator.py           # 跨平台启动脚本
├── requirements.txt            # Python依赖列表
├── README.md                   # 项目说明文档
├── 数据来源说明.md            # 数据来源详细文档
├── marriage_calculator_config.json  # 用户配置（运行时生成）
├── font_test.png              # 字体测试图片（运行时生成）
└── *.log                      # 日志文件（运行时生成）
```

### 🔍 核心算法

#### 现金流预测算法

```python
def calculate_cash_flow(income, expenses, inflation_rate, years):
    """
    计算未来现金流
    Args:
        income: 年收入
        expenses: 年支出
        inflation_rate: 通胀率
        years: 预测年数
    Returns:
        现金流时间序列
    """
    cash_flow = []
    for year in range(years):
        # 考虑通胀的支出增长
        adjusted_expenses = expenses * (1 + inflation_rate) ** year
        # 考虑收入增长的收入增加（简化为通胀率的一半）
        adjusted_income = income * (1 + inflation_rate * 0.5) ** year
        # 计算年度净现金流
        annual_cash_flow = adjusted_income - adjusted_expenses
        cash_flow.append(annual_cash_flow)
    return cash_flow
```

#### 风险评估算法

```python
def calculate_risk_score(monthly_income, monthly_expenses, assets, debts):
    """
    计算综合风险评分
    Args:
        monthly_income: 月收入
        monthly_expenses: 月支出
        assets: 总资产
        debts: 总负债
    Returns:
        风险评分 (0-100, 越高风险越大)
    """
    # 现金流比率
    cash_flow_ratio = monthly_income / monthly_expenses

    # 资产负债比率
    debt_ratio = debts / (assets + debts) if (assets + debts) > 0 else 1

    # 综合风险评分
    risk_score = (2 - cash_flow_ratio) * 30 + debt_ratio * 40

    return min(max(risk_score, 0), 100)
```

### 🎨 UI设计规范

#### 配色方案

| 颜色 | RGB值 | 用途 | 含义 |
|-----|------|------|------|
| **主色调** | #3b82f6 | 主要按钮、链接 | 信任、可靠 |
| **成功色** | #10b981 | 正向指标、确认 | 安全、增长 |
| **警告色** | #f59e0b | 警示信息、重点 | 注意、谨慎 |
| **危险色** | #ef4444 | 风险提示、错误 | 警告、停止 |
| **背景色** | #f8fafc | 主背景 | 干净、清爽 |

#### 字体层次

| 层级 | 字体大小 | 字重 | 用途 |
|-----|---------|------|------|
| **标题1** | 24px | Bold | 页面主标题 |
| **标题2** | 18px | Bold | 模块标题 |
| **正文** | 12px | Normal | 一般文字 |
| **小字** | 10px | Normal | 辅助信息 |
| **数据** | 14px | Mono | 数值显示 |

---

## 🤝 贡献指南 {#%E8%B4%A1%E7%8C%AE%E6%8C%87%E5%8D%97}

### 💻 开发环境设置

1. **Fork项目**
   ```bash
   git clone https://github.com/abwoo/Marriage-Parenting-Cost-Calculator.git
   cd Marriage-Parenting-Cost-Calculator
   ```

2. **创建虚拟环境**
   ```bash
   python -m venv venv
   source venv/bin/activate  # Linux/macOS
   venv\Scripts\activate     # Windows
   ```

3. **安装开发依赖**
   ```bash
   pip install -r requirements.txt
   pip install pytest flake8 black  # 开发工具
   ```

4. **运行测试**
   ```bash
   pytest tests/
   flake8 marriage_calculator.py
   ```

### 📝 代码规范

#### Python代码风格

```python
# 使用black格式化代码
black marriage_calculator.py

# 使用flake8检查代码质量
flake8 --max-line-length=100 marriage_calculator.py
```

#### 提交规范

```bash
# 提交信息格式
<type>(<scope>): <subject>

# 示例
feat(ui): 添加深色主题支持
fix(calc): 修复现金流计算错误
docs(readme): 更新安装说明
```

#### 分支管理

```bash
# 创建功能分支
git checkout -b feature/new-feature

# 提交更改
git commit -m "feat: 添加新功能"

# 推送分支
git push origin feature/new-feature

# 创建Pull Request
```

### 🐛 问题反馈

#### Bug报告模板

```markdown
## Bug描述
[清晰简洁地描述问题]

## 重现步骤
1. 打开程序
2. 点击 '...'
3. 输入 '...'
4. 看到错误

## 期望行为
[描述期望的结果]

## 环境信息
- OS: [e.g. Windows 10]
- Python: [e.g. 3.9.0]
- 程序版本: [e.g. v1.0.0]

## 附加信息
[其他相关信息、截图等]
```

#### 功能请求模板

```markdown
## 功能描述
[描述您想要的功能]

## 使用场景
[说明这个功能的应用场景]

## 实现建议
[如果有想法，描述实现方式]

## 优先级
[高/中/低]
```

---

## 📝 更新日志 {#%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97}

### [v1.1.0] - 2024-01-21

#### ✨ 新增功能
- 🔧 智能字体检测和自动配置
- 🌍 多城市预设配置（一线、二线、三线城市）
- ⚖️ 风险偏好配置（保守、平衡、激进）
- 📊 实时数据验证和错误提示
- 💾 自动配置备份和恢复

#### 🐛 修复问题
- ✅ 修复matplotlib中文字体显示问题
- ✅ 修复图表数值标签显示异常
- ✅ 修复程序启动时的配置加载错误
- ✅ 修复数据导出格式问题

#### 📚 文档更新
- 📖 重写完整README文档
- 📊 添加详细数据来源说明
- 🛠️ 添加故障排除指南
- 🤝 添加贡献者指南

### [v1.0.0] - 2024-01-15

#### ✨ 初始版本
- 💰 完整的结婚生育成本计算功能
- 📈 18年财务规划可视化
- 🤖 AI智能分析报告
- 💾 数据保存和导出
- 🎨 现代化GUI界面

---

## 📄 许可证 {#%E8%AE%B8%E5%8F%AF%E8%AF%81}

本项目采用 **MIT许可证** 开源协议。

```
MIT License

Copyright (c) 2024 Marriage Calculator

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

---

## 🙋‍♂️ 常见问题 {#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98}

### 💰 关于数据准确性

**Q: 这些数据准确吗？**
A: 数据基于2023年国家统计局和相关机构发布的权威数据。对于具体城市和个人情况，建议根据实际情况调整参数。

**Q: 房价数据会过期吗？**
A: 是的，房价数据会随市场变化。建议每年根据当地房价指数更新数据。

### 🧮 关于计算方法

**Q: 通胀率是如何应用的？**
A: 程序使用复利计算，对未来支出按年度通胀率进行调整，确保预测结果更符合实际。

**Q: 投资收益是如何计算的？**
A: 假设每月结余的20%用于投资，按年化收益率计算复利收益。

### 💻 关于技术问题

**Q: 支持哪些操作系统？**
A: 支持Windows 7+、macOS 10.12+、Ubuntu 16.04+等主流操作系统。

**Q: 内存占用多少？**
A: 正常使用约50-100MB，生成复杂图表时峰值约200MB。

**Q: 数据会保存到哪里？**
A: 配置数据保存为JSON文件在程序目录下，可以手动备份或迁移。

### 📊 关于结果解读

**Q: 抗风险系数多少算合适？**
A: 一般来说，1.5以上比较健康，1.0-1.5需要注意，1.0以下需要调整支出或增加收入。

**Q: 现金流为负数怎么办？**
A: 建议减少不必要支出、增加收入来源，或调整购房等大额支出计划。

**Q: 如何优化财务状况？**
A: 程序的AI分析会提供针对性的建议，包括控制支出、增加收入、优化投资等。

### 🔄 关于更新维护

**Q: 程序会定期更新吗？**
A: 会根据国家统计数据更新和用户反馈进行维护。主要数据来源会随统计年鉴更新。

**Q: 如何获取最新版本？**
A: 关注项目仓库的[Release页面](https://github.com/abwoo/Marriage-Parenting-Cost-Calculator/releases)，或通过程序内的更新检查功能。

---

## 📞 联系我们

- 📧 **邮箱**: support@Marriage-Parenting-Cost-Calculator.com
- 🐛 **问题反馈**: [GitHub Issues](https://github.com/abwoo/Marriage-Parenting-Cost-Calculator/issues)
- 📖 **文档**: [GitHub Wiki](https://github.com/abwoo/Marriage-Parenting-Cost-Calculator/wiki)
- 💬 **讨论**: [GitHub Discussions](https://github.com/abwoo/Marriage-Parenting-Cost-Calculator/discussions)

---

<div align="center">

**💝 祝您家庭幸福，财务自由！💝**

*Made with ❤️ for better family financial planning*

</div>
